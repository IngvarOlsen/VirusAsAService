<!-- {% extends "base.html" %}
{% block title %}Login{% endblock %}
{% block content %} -->

<!-- Meta and base style will be moved to base.html -->
<meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
      crossorigin="anonymous"
    />

<style>

    /* General Wrapper and Container Styling */
.loginWrapper {
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: 100vh;
    background-color: #f4f4f9;
}

.container {
    background-color: #ffffff;
    padding: 2rem;
    max-width: 400px;
    width: 100%;
    border-radius: 8px;
    box-shadow: 0px 4px 12px rgba(0, 0, 0, 0.1);
    text-align: center;
}

/* Image Styling */
.random-hover-effect img {
    transition: transform 0.3s ease;
}

.random-hover-effect img:hover {
    transform: scale(1.1);
}

/* Form Titles */
.formTitle {
    font-size: 1.8rem;
    margin-bottom: 1.5rem;
    color: #333;
}

/* Form Styling */
.form-group {
    margin-bottom: 1rem;
    text-align: left;
}

.form-group label {
    font-size: 0.9rem;
    color: #555;
}

.input {
    width: 100%;
    padding: 0.8rem;
    font-size: 1rem;
    border: 1px solid #ddd;
    border-radius: 4px;
    outline: none;
    transition: border-color 0.3s;
}

.input:focus {
    border-color: #007bff;
}

/* Button Styling */
button {
    cursor: pointer;
    font-size: 1rem;
    padding: 0.8rem 1.2rem;
    margin-top: 1rem;
    border: none;
    border-radius: 4px;
    transition: background-color 0.3s;
}

.loginBtn {
    background-color: #007bff;
    color: #fff;
    width: 100%;
}

.loginBtn:hover {
    background-color: #0056b3;
}

.newUserBtn, .cancelBtn, .resetConfirm {
    background-color: #f4f4f4;
    color: #333;
    width: 100%;
    margin-top: 0.5rem;
}

.newUserBtn:hover, .cancelBtn:hover, .resetConfirm:hover {
    background-color: #e0e0e0;
}

.registerBtn {
    background-color: #28a745;
    color: #fff;
    width: 100%;
}

.registerBtn:hover {
    background-color: #218838;
}

/* Password Strength Indicator */
#PasswordForm {
    margin: 1.5rem 0;
}

#password-str .box {
    display: inline-block;
    width: 20%;
    height: 6px;
    background-color: #e0e0e0;
    margin-right: 5px;
    border-radius: 2px;
}

#password-str .box .bar {
    height: 100%;
    transition: background-color 0.3s;
}

.box1 .bar { background-color: #ff4f4f; }
.box2 .bar { background-color: #ffbd4f; }
.box3 .bar { background-color: #ffe74f; }
.box4 .bar { background-color: #28a745; }

/* Forgot Password Section */
.forgotPasswordBtn p {
    font-size: 0.85rem;
    color: #007bff;
    cursor: pointer;
    text-decoration: underline;
    margin-top: 1rem;
}

.forgotPasswordBtn p:hover {
    color: #0056b3;
}

</style>
<div class="loginWrapper">
	<div class="container">
		
		<!-- Logo or image -->
		<div class="random-hover-effect">
			<!-- <img src="{{ url_for('static', filename='butler.png') }}" style="height: 200px;" alt="Logo of Bitlus"> -->
            <img src="butlercoat.PNG" style="height: 200px;" alt="Logo of Bitlus">
          
		</div>

		<!-- Login form -->
		<form method="POST" action="/login" class="form loginForm">
			<h3 class="formTitle" align="center">Login</h3>
			<div class="form-group">
				<label for="email">Email Address</label>
				<input type="email" class="input form-control" id="email" name="email" placeholder="Enter email">
			</div>
			<div class="form-group">
				<label for="password">Password</label>
				<input type="password" class="input form-control" id="password" name="password" placeholder="Enter password">
			</div>
			<button type="submit" class="loginBtn btn btn-primary">Login</button>
			<button class="newUserBtn" onclick="newUserView()" type="button">New User</button>
			<div class="forgotPasswordBtn">
				<p>Forgot your password?</p>
			</div>
		</form>

		<!-- Register form (hidden by default) -->
		<form method="POST" action="/sign-up" class="form registerForm" style="display: none;">
			<h2 class="formTitle">Create a new user</h2>
			<input type="text" name="email" placeholder="Email">
			<input type="password" name="password1" id="newPassword" maxlength="20" placeholder="Password">
			<input type="password" name="password2" maxlength="20" placeholder="Repeat Password">
			
			<!-- Password strength indicator -->
			<div id="PasswordForm">
				<div id="password-str">
					<div class="box box1"><div class="bar-text"></div><div class="bar"></div></div>
					<div class="box box2"><div class="bar"></div></div>
					<div class="box box3"><div class="bar"></div></div>
					<div class="box box4"><div class="bar"></div></div>
				</div>
			</div>
			<button type="submit" class="registerBtn">Create</button>
			<button class="cancelBtn" onclick="cancelToStart()" type="button">Cancel</button>
		</form>

		<!-- Forgot password form (hidden by default) -->
		<form class="form forgotPasswordForm" style="display: none;">
			<h2 class="formTitle">Reset Password</h2>
			<p style="margin-bottom: 25px;">A mail will be sent to your address, with a guide and link to reset your password</p>
			<input type="text" placeholder="Email">
			<button type="submit" class="resetConfirm">Reset</button>
			<button class="cancelBtn" onclick="cancelToStart()" type="button">Cancel</button>
		</form>

	</div>
</div>

<script src="https://code.jquery.com/jquery-3.7.1.min.js" crossorigin="anonymous"></script>

<script>

    // View Controller
$(document).ready(function() {
    // Hide non-default forms on load
    $('.registerForm').hide();
    $('.forgotPasswordForm').hide();

    // Show the Register form when "New User" button is clicked
    $('.newUserBtn').click(function(e) {
        e.preventDefault();
        $('.loginForm').hide();
        $('.registerForm').fadeIn(500);
    });

    // Show the Forgot Password form when "Forgot Password?" link is clicked
    $('.forgotPasswordBtn p').click(function(e) {
        e.preventDefault();
        $('.loginForm').hide();
        $('.forgotPasswordForm').fadeIn(500);
    });

    // Function to return to the Login view
    function cancelToStart() {
        $('.registerForm').hide();
        $('.forgotPasswordForm').hide();
        $('.loginForm').fadeIn(500);
    }

    // Attach cancel function to all cancel buttons
    $('.cancelBtn').click(function(e) {
        e.preventDefault();
        cancelToStart();
    });

    // Password Strength Checker
    console.log("Password strength checker loaded");
    var result = $("#password-str");

    $('#newPassword').keyup(function() {
        $(".bar-text").html(checkStr($('#newPassword').val()));
    });

    function checkStr(password) {
        var strength = 0;

        if (password.length === 0) {
            result.removeClass();
            return '';
        }

        if (password.length < 9) {
            result.removeClass();
            result.addClass('normal');
            return 'Normal';
        }

        if (password.length > 9) strength += 1;
        if (password.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)) strength += 1;
        if (password.match(/([!,%,&,@,#,$,^,*,?,_,~])/)) strength += 1;
        if (password.match(/(.*[!,%,&,@,#,$,^,*,?,_,~].*[!,%,&,@,#,$,^,*,?,_,~])/)) strength += 1;

        // Adjust strength level
        if (strength < 2) {
            result.removeClass().addClass('medium');
            return 'Medium';
        } else if (strength === 2) {
            result.removeClass().addClass('strong');
            return 'Strong';
        } else {
            result.removeClass().addClass('vstrong');
            return 'Very Strong';
        }
    }
});
</script>


<!-- Link to JavaScript file -->
<script src="{{ url_for('static', filename='login.js') }}"></script>



{% endblock %}